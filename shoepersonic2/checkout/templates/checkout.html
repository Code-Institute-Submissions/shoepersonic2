{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block page_title %}Checkout{% endblock %}
{% block page_header %}Checkout{% endblock %}
{% block content %}
<nav class="nav nav-pills nav-fill">
    <a class="nav-item nav-link" href="{% url 'contact_details' %}">Contact</a>
    <a class="nav-item nav-link" href="{% url 'delivery_details' %}">Delivery</a>
    <a class="nav-item nav-link active" href="{% url 'card_details' %}">Payment</a>
</nav>
<div class="checkout-basket">
    <h5>Your basket</h5>    
    <ul class="list-group">
    {% for item in basket_items %}
        <li class="list-group-item d-flex justify-content-between">
            <div>
                <h6>{{ item.product.name }}</h6>
            </div>
            <div>
                <h6>£{{ item.product.price }}</h6> 
            </div>
        </li>
        {% endfor %}
        <li class="list-group-item d-flex justify-content-between">
            <div>
                <h6>Total: <span>£{{ total }}</span></h6>
            </div>
        </li>
    </ul>
</div>
<form action="{% url 'submit_order' %}" method="post" id="payment-form" role="form">
    {% csrf_token %}
    <div class="form-row">
        <label for="card-element">
            Credit or debit card details
        </label>
        <div id="card-element">
            <!-- A Stripe Element will be inserted here. -->
        </div>
        
        <!-- Used to display Element errors. -->
        <div id="card-errors" role="alert"></div>
    </div>
    <input class="btn btn-block btn-primary btn-lg btn-danger next-button" id="submit_payment_btn" name="commit" type="submit" value="Submit Payment">
</form>
{% endblock %}